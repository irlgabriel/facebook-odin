
<div class="d-flex flex-column w-50" style='background-color: #F5F5F5;'>

  <div class='container-fluid bg-white rounded-20'>
    <%= form_for Post.new do |f| %>
      <%= f.text_field :body, placeholder: 'What is on your mind?', class:'mt-3 form-control form-border bg-light', data: {toggle: 'collapse', target:'#submit-toggler'} %>
      <hr class='my-4'>

      <div id='submit-toggler' class='collapse'>
        <%= f.submit :save, value: 'Post', class:'btn btn-white btn-outline-dark mb-3 w-100' %>
      </div>


    <% end %>
  </div>

  <% @posts.each do |post| %>
  
  <div class="card w-100 my-3" style="background-color: white" >
    <div class='card-body'>
      <h5 class='card-title'><%= link_to post.author.first_name + ' ' +  post.author.last_name, profile_path(post.author), class:'font-weight-bold text-dark' %></h5>
      <p class='card-text text-muted'><%= distance_of_time_in_words post.created_at, Time.now %></p>
      <p class='card-text'><%= post.body %></p>

      <% if post.user_id == current_user.id %>

        <div class='post-buttons text-right'>
          <%= link_to 'Edit', edit_post_path(post), class:'lead text-dark' %>
          <%= link_to 'Delete', post, method: :delete, data: {confirm: 'Are you sure you want to delete this post?'}, class:'lead text-dark' %>    
        </div>

      <% end %>

      <div class='container-fluid my-3'>

        <%= form_for post.comments.new, url: post_comments_path(post) do |f| %>
          <%= f.text_field :body, placeholder: 'Write a comment...', class:'bg-light form-control form-border' %>
          
        <% end %>

        <button class='my-3 btn btn-outline-white' data-toggle='collapse' data-target='#comments-collapsable'>View Comments</button>

        <div id='comments-collapsable' class='row collapse container-fluid my-2'>
          <% post.comments.each do |comment| %>
            <p class='col-8'><%= comment.body %></p>
            <div class='col-2'>
              <button class='btn btn-outline-white' data-toggle='collapse' data-target='#comment-edit-collapsable'>Edit</button>
              <div id='comment-edit-collapsable' class='container-fluid'>
                <%= form_for comment, url: edit_post_comment_path(post_id: post.id, id: comment.id) do |f| %>
                  <%= f.text_field :body, default: comment.body %>
                <% end %>
              </div>
            </div>
            <p class='col-2'>Edit</p>
          <% end %>
        </div>
      </div>
    </div>
  </div>
 <% end %>
</div>