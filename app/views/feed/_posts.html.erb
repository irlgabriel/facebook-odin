
<div class='col-6'>

  <!-- Form for creating posts on the feed -->

  <div class='bg-white py-3 mt-4 border-radius-10'>
    <%= form_for @post do |f| %>
      <%= f.text_field :body, placeholder: "What is on your mind, #{current_user.last_name}?", class:'w-90 mx-auto bg-light form-control border-radius-40'%>
    <% end %>
    <hr class='w-90 mb-1'>
  </div>

  <!-- Actual feed posts -->

  <% @posts.each do |post| %>
    <div class='card my-4 border-radius-10'>
      <div class='card-body'>
        <h4 class='card-title'><%= post.author.fullname %></h4>
        <p class='text-muted'><%= distance_of_time_in_words(post.created_at, Time.now) %></p>
        <p class='card-text'><%= post.body %></p>

        <!-- buttons for the author of the post -->

        <% if current_user == post.author %>
          <div class='card-text card-author-buttons text-right'>
            <%= link_to 'Delete', post, method: :delete, data: {confirm: 'Are you sure you want to delete this post?'}, class: 'btn btn-outline-white'%>
            <%= link_to 'Edit', edit_post_path(post), data: {toggle: 'collapse', target: '#comment_edit'}, class: 'btn btn-outline-white' %>
          </div>
        <% end %>

        <!-- comments info -->

        <p class='card-text'><%= post.comments.count %> Comments</p>
        <% #unless post.comments.count == 0 %>      
        <button data-toggle='collapse' data-target='#comments-collapsable' class='btn btn-outline-white'>View comments</button>
        <% #end %>
        
        <!-- collapsable commments div with form (facebook layout) -->

        <div id='comments-collapsable' class='collapse'>

          <!-- comment form -->


          <%= form_for Comment.new, url: post_comments_path(post) do |f| %>
            <%= f.text_field :body, placeholder: 'Write a commment...', class:'mt-3 border-radius-20 form-control'%>
            <%= f.submit :save, value: 'Save', class:'btn w-25 mx-auto btn-outline-white' %>
          <% end %>

          <!-- comments list -->

          <% post.comments.each do |comment| %>
          <div class='p-2 bg-light border-radius-20 d-inline-block'>
            <h5><%= post.author.fullname %></h5>
            <p class='mb-0'><%= comment.body %></p>
          </div>
          <% end %>
        </div>


      </div>
    </div>
  <% end %>
</div>